import{a as ue}from"./chunk-BYI4GQNY.js";import{a as de}from"./chunk-BBNXGYOG.js";import{b as we,c as ye,d as Ie,e as Ae,f as Ue,g as Ee,h as Me,i as Te,j as Re,k as De,l as Fe,m as ke,n as Le,o as Pe,p as Ne}from"./chunk-N4EAPRBL.js";import{a as ie,b as ne,c as re,j as le}from"./chunk-JNRCB37G.js";import{v as pe,w as ce}from"./chunk-HM5AIPJZ.js";import{a as Se}from"./chunk-GMUQQUFC.js";import{b as fe,d as q,f as _e,g as ge,i as he,j as ve,k as xe,l as Ce,n as L,o as be,p as P,q as N,r as j,s as z}from"./chunk-YL2U7DAQ.js";import{T as M,U as T,V as R,ia as oe,ja as ae,oa as se,pa as me,ra as D,sa as F,ua as k}from"./chunk-UA7J2MJT.js";import{a as w}from"./chunk-GPXQT2VE.js";import{Eb as X,Ja as p,K as G,La as l,Nb as Y,Ob as E,P as Z,S as W,Sa as J,Wa as s,Xa as r,Xb as ee,Y as I,Ya as u,Za as h,_a as v,ab as b,ca as x,cc as te,d as y,da as C,db as g,ec as H,fb as f,g as B,mb as K,nb as d,ob as A,pb as S,sb as U,ua as o,ub as O,va as c,zb as Q}from"./chunk-UIBI7PPD.js";var V=(()=>{let i=class i{constructor(t){this._httpClient=t}getAdminUsers(t){return this._httpClient.get(w.PORTAL_USERS,{params:Ne(t)})}createAdminUser(t){return this._httpClient.post(w.PORTAL_USERS,t)}updateAdminUser(t,m){return this._httpClient.patch(`${w.PORTAL_USERS}${t}`,m)}deleteAdminUser(t){return this._httpClient.delete(`${w.PORTAL_USERS}${t}`)}};i.\u0275fac=function(m){return new(m||i)(W(ee))},i.\u0275prov=Z({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();function Je(e,i){if(e&1&&(s(0,"fuse-alert",17),d(1),r()),e&2){let a=f();l("appearance","outline")("showIcon",!1)("type",a.alert.type)("@shake",a.alert.type==="error"),o(),S(" ",a.alert.message," ")}}function Ke(e,i){e&1&&(s(0,"mat-error"),d(1," Name is required "),r())}function Qe(e,i){e&1&&(s(0,"mat-error"),d(1," Email is required "),r())}function Xe(e,i){e&1&&(s(0,"span"),d(1," Save "),r())}function Ye(e,i){e&1&&u(0,"mat-progress-spinner",18),e&2&&l("diameter",24)("mode","indeterminate")}var Ve=(()=>{let i=class i{constructor(t,m,n,_){this._formBuilder=t,this._adminUsersService=m,this.matDialogRef=n,this.data=_,this.subscription=new y,this.alert={type:"success",message:""},this.showAlert=!1,this.isLoading=!1}ngOnInit(){this.createForm=this._formBuilder.group({name:[this.data?.name??"",[q.required]],email:[this.data?.email??"",[q.required]],password:[null]})}save(){this.createForm.invalid||(this.showAlert=!1,this.isLoading=!0,this.data?this.subscription.add(this._adminUsersService.updateAdminUser(this.data.id,this.createForm.value).subscribe({next:()=>this.matDialogRef.close(!0),error:t=>this.onFailed(t.status===500?"500: Internal Server Error":t.error)})):this.subscription.add(this._adminUsersService.createAdminUser(this.createForm.value).subscribe({next:()=>this.matDialogRef.close(!0),error:t=>this.onFailed(t.status===500?"500: Internal Server Error":t.error)})))}onFailed(t){this.alert={type:"error",message:t},this.showAlert=!0,this.isLoading=!1,this.createForm.enable()}ngOnDestroy(){this.subscription?.unsubscribe()}};i.\u0275fac=function(m){return new(m||i)(c(Ce),c(V),c(ie),c(ne))},i.\u0275cmp=I({type:i,selectors:[["app-admin-user"]],standalone:!0,features:[U],decls:27,vars:14,consts:[[1,"flex","flex-col","flex-auto","md:w-160","md:min-w-160","max-h-160","-m-6","overflow-y-auto"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","",3,"click","tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","w-full","p-6","sm:p-8","overflow-y-auto"],["class","mb-4",3,"appearance","showIcon","type",4,"ngIf"],[3,"formGroup"],[1,"w-full","mb-2"],["id","name","matInput","","placeholder","Enter Name",3,"formControlName"],[4,"ngIf"],[1,"w-full"],["id","address_1","matInput","","placeholder","Enter email",3,"formControlName"],["id","password","type","password","matInput","","placeholder","Enter password",3,"formControlName"],[1,"flex","justify-end"],["mat-flat-button","",1,"fuse-mat-button-large","mt-3",3,"click","color","disabled"],[3,"diameter","mode",4,"ngIf"],[1,"mb-4",3,"appearance","showIcon","type"],[3,"diameter","mode"]],template:function(m,n){m&1&&(s(0,"div",0)(1,"div",1)(2,"div",2),d(3),r(),s(4,"button",3),g("click",function(){return n.matDialogRef.close()}),u(5,"mat-icon",4),r()(),s(6,"div",5),p(7,Je,2,5,"fuse-alert",6),s(8,"form",7)(9,"mat-form-field",8)(10,"mat-label"),d(11,"Name"),r(),u(12,"input",9),p(13,Ke,2,0,"mat-error",10),r(),s(14,"mat-form-field",11)(15,"mat-label"),d(16,"Email"),r(),u(17,"input",12),p(18,Qe,2,0,"mat-error",10),r(),s(19,"mat-form-field",11)(20,"mat-label"),d(21,"Password"),r(),u(22,"input",13),r(),s(23,"div",14)(24,"button",15),g("click",function(){return n.save()}),p(25,Xe,2,0,"span",10)(26,Ye,1,2,"mat-progress-spinner",16),r()()()()()),m&2&&(o(3),S("",n.data?"Edit":"New"," Admin User"),o(),l("tabIndex",-1),o(),l("svgIcon","heroicons_outline:x-mark"),o(2),l("ngIf",n.showAlert),o(),l("formGroup",n.createForm),o(4),l("formControlName","name"),o(),l("ngIf",n.createForm.get("name").hasError("required")),o(4),l("formControlName","email"),o(),l("ngIf",n.createForm.get("email").hasError("required")),o(4),l("formControlName","password"),o(2),l("color","primary")("disabled",n.createForm.disabled||n.isLoading),o(),l("ngIf",!n.createForm.disabled&&!n.isLoading),o(),l("ngIf",n.createForm.disabled||n.isLoading))},dependencies:[L,he,fe,_e,ge,ve,xe,z,P,be,se,oe,ae,j,N,R,M,T,F,D,E],data:{animation:k}});let e=i;return e})();var et=e=>({"sm:mb-18":e}),tt=e=>({"pointer-events-none":e});function it(e,i){if(e&1&&(s(0,"fuse-alert",16),d(1),r()),e&2){let a=f();l("appearance","outline")("showIcon",!1)("type",a.alert.type)("@shake",a.alert.type==="error"),o(),S(" ",a.alert.message," ")}}function nt(e,i){e&1&&(s(0,"th",27),d(1," Name"),r())}function rt(e,i){if(e&1&&(s(0,"td",28),d(1),r()),e&2){let a=i.$implicit;o(),A(a.name)}}function ot(e,i){e&1&&(s(0,"th",27),d(1," Email"),r())}function at(e,i){if(e&1&&(s(0,"td",28),d(1),r()),e&2){let a=i.$implicit;o(),A(a.email||"-")}}function st(e,i){e&1&&(s(0,"th",27),d(1," Role"),r())}function mt(e,i){if(e&1&&(s(0,"td",28),d(1),r()),e&2){let a=i.$implicit;o(),A(a.role||"-")}}function lt(e,i){e&1&&(s(0,"th",27),d(1," Action"),r())}function dt(e,i){if(e&1){let a=b();s(0,"button",32),g("click",function(){x(a);let m=f().$implicit,n=f(2);return C(n.deleteConfirmation(m))}),u(1,"mat-icon",33),r()}e&2&&(o(),l("svgIcon","heroicons_outline:trash"))}function pt(e,i){if(e&1){let a=b();s(0,"td",28)(1,"button",29),g("click",function(){let m=x(a).$implicit,n=f(2);return C(n.openAdminModal(m))}),u(2,"mat-icon",10),r(),s(3,"button",30),g("click",function(){let m=x(a).$implicit,n=f(2);return C(n.viewAdminLogs(m.id))}),u(4,"mat-icon",10),r(),p(5,dt,2,1,"button",31),r()}if(e&2){let a=i.$implicit,t=f(2);o(2),l("svgIcon","heroicons_outline:pencil"),o(2),l("svgIcon","mat_outline:manage_search"),o(),J(t.user.id!==a.id?5:-1)}}function ct(e,i){e&1&&u(0,"tr",34)}function ut(e,i){e&1&&u(0,"tr",35)}function ft(e,i){if(e&1){let a=b();h(0),s(1,"table",17),h(2,18),p(3,nt,2,0,"th",19)(4,rt,2,1,"td",20),v(),h(5,21),p(6,ot,2,0,"th",19)(7,at,2,1,"td",20),v(),h(8,22),p(9,st,2,0,"th",19)(10,mt,2,1,"td",20),v(),h(11,23),p(12,lt,2,0,"th",19)(13,pt,6,3,"td",20),v(),p(14,ct,1,0,"tr",24)(15,ut,1,0,"tr",25),r(),s(16,"mat-paginator",26),g("page",function(m){x(a);let n=f();return C(n.handlePageEvent(m))}),r(),v()}if(e&2){let a=f();o(),l("dataSource",a.adminUsers),o(13),l("matHeaderRowDef",a.displayedColumns)("matHeaderRowDefSticky",!0),o(),l("matRowDefColumns",a.displayedColumns),o(),l("ngClass",O(10,tt,a.isLoading))("length",a.pagination.length)("pageIndex",a.pagination.page)("pageSize",a.pagination.size)("pageSizeOptions",a.pageSize)("showFirstLastButtons",!0)}}function _t(e,i){e&1&&(s(0,"div",37),d(1," There are no users! "),r())}function gt(e,i){if(e&1&&p(0,_t,2,0,"div",36),e&2){let a=f();l("ngIf",!a.isLoading)}}function ht(e,i){e&1&&(h(0),s(1,"div",38),u(2,"mat-progress-spinner",39),s(3,"h4",40),d(4,"Fetching your admin users..."),r()(),v())}var Oe=(()=>{let i=class i{constructor(t,m,n,_,$,He,qe,$e){this._changeDetectorRef=t,this._activatedRoute=m,this._fuseConfirmationService=n,this._router=_,this._userService=$,this._adminUsersService=He,this._matDialog=qe,this.router=$e,this._subscription=new y,this._unsubscribeAll=new B,this.displayedColumns=["name","email","role","action"],this.pageSize=Pe,this.pagination={length:0,page:0,size:this.pageSize[0],role:ue.ADMIN},this.alert={type:"success",message:""},this.showAlert=!1,this.isLoading=!1}ngOnInit(){this.pagination.page=Number(this._activatedRoute.snapshot.queryParamMap.get("page")??0),this.pagination.size=Number(this._activatedRoute.snapshot.queryParamMap.get("size")??this.pageSize[0]),this._userService.user$.pipe(G(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.isLoading=!0,this.getAdminUsers()}openAdminModal(t=null){this._subscription.add(this._matDialog.open(Ve,{data:t,disableClose:!0}).afterClosed().subscribe({next:m=>{m&&this.getAdminUsers()}}))}getAdminUsers(){this.isLoading=!0,this.queryParamHandler(),this._subscription.add(this._adminUsersService.getAdminUsers(this.pagination).subscribe({next:t=>{this.adminUsers=t.items,this.pagination.length=t.total,this.isLoading=!1},error:t=>{t.status!==404&&this.onFailed(t.status===500?"500: Internal Server Error":t.error.detail),this.isLoading=!1}}))}queryParamHandler(){this._router.navigate(["."],{relativeTo:this._activatedRoute,queryParams:{page:this.pagination.page,size:this.pagination.size}}).then()}handlePageEvent(t){this.pagination.length=t.length,this.pagination.size=t.pageSize,this.pagination.page=t.pageIndex,this.getAdminUsers()}deleteConfirmation(t){this._subscription.add(this._fuseConfirmationService.open({title:"Remove this user",message:"Are you sure you want to remove this user permanently?",icon:{show:!0,name:"heroicons_outline:exclamation-triangle",color:"warn"},actions:{confirm:{show:!0,label:"Remove",color:"warn"},cancel:{show:!0,label:"Cancel"}},dismissible:!0}).afterClosed().subscribe(m=>{m==="confirmed"&&this.deleteZitadelUser(t)}))}deleteZitadelUser(t){this.isLoading=!0,this.showAlert=!1,this._subscription.add(this._adminUsersService.deleteAdminUser(t.id).subscribe({next:()=>this.getAdminUsers(),error:m=>this.onFailed(m.status===500?"500: Internal Server Error":m.error)}))}viewAdminLogs(t){this.router.navigate([Se.PORTAL_LOGS],{queryParams:{portal_user_id:t}}).then()}onFailed(t){this.alert={type:"error",message:t},this.showAlert=!0,this.isLoading=!1}ngOnDestroy(){this._subscription?.unsubscribe()}};i.\u0275fac=function(m){return new(m||i)(c(X),c(te),c(le),c(H),c(de),c(V),c(re),c(H))},i.\u0275cmp=I({type:i,selectors:[["app-admin-users"]],standalone:!0,features:[U],decls:20,vars:9,consts:[["noClients",""],[1,"sm:absolute","sm:inset-0","flex","flex-col","flex-auto","min-w-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"border-b"],[1,"flex","flex-col","w-full","px-6"],[1,"flex","flex-col","sm:flex-row","flex-auto","sm:items-center","min-w-0","my-8"],[1,"flex","flex-auto","items-center","min-w-0"],[1,"flex","flex-col","min-w-0","ml-4"],["id","Clients",1,"text-2xl","md:text-5xl","font-semibold","tracking-tight","leading-7","md:leading-snug","truncate"],[1,"flex","items-center","mt-6","sm:mt-0","sm:ml-2","space-x-3"],["mat-flat-button","",3,"click","color"],[1,"icon-size-5",3,"svgIcon"],["class","mb-6",3,"appearance","showIcon","type",4,"ngIf"],[1,"relative","flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:overflow-y-auto",3,"ngClass"],[4,"ngIf","ngIfElse"],[4,"ngIf"],[1,"mb-6",3,"appearance","showIcon","type"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","email"],["matColumnDef","role"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"page","ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","matTooltip","edit",3,"click"],["mat-icon-button","","matTooltip","view portal logs",3,"click"],["mat-icon-button","","matTooltip","delete"],["mat-icon-button","","matTooltip","delete",3,"click"],[1,"icon-size-5","text-red-500",3,"svgIcon"],["mat-header-row",""],["mat-row",""],["class","p-8 sm:p-16 text-4xl font-semibold tracking-tight text-center",4,"ngIf"],[1,"p-8","sm:p-16","text-4xl","font-semibold","tracking-tight","text-center"],[1,"w-full","h-full","flex","flex-col","justify-center","items-center","bg-default"],["color","primary","diameter","50","strokeWidth","5","mode","indeterminate"],[1,"mt-16"]],template:function(m,n){if(m&1){let _=b();s(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7),d(7," Admin Users "),r()()(),s(8,"div",8)(9,"button",9),g("click",function(){return x(_),C(n.openAdminModal())}),u(10,"mat-icon",10),s(11,"span"),d(12,"Add"),r()()()(),p(13,it,2,5,"fuse-alert",11),r()(),s(14,"div",12)(15,"div",13),p(16,ft,17,12,"ng-container",14)(17,gt,1,1,"ng-template",null,0,Q)(19,ht,5,0,"ng-container",15),r()()()}if(m&2){let _=K(18);o(9),l("color","primary"),o(),l("svgIcon","heroicons_solid:plus"),o(3),l("ngIf",!n.isLoading&&n.showAlert),o(2),l("ngClass",O(7,et,(n.adminUsers==null?null:n.adminUsers.length)>0)),o(),l("ngIf",(n.adminUsers==null?null:n.adminUsers.length)>0)("ngIfElse",_),o(3),l("ngIf",n.isLoading&&!n.adminUsers)}},dependencies:[z,me,F,D,P,ye,we,j,N,ce,pe,E,L,R,M,T,Y,Le,Ie,Ue,Re,Ee,Ae,De,Me,Te,Fe,ke],data:{animation:k}});let e=i;return e})();var ai=[{path:"",component:Oe}];export{ai as default};

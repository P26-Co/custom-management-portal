import{b as ee,c as te,d as ie,e as ne,f as ae,g as oe,h as re,i as le,j as se,k as me,l as pe,m as de,n as _e,o as ce,p as ue}from"./chunk-N4EAPRBL.js";import{v as G,w as W}from"./chunk-HM5AIPJZ.js";import{n as J,p as K,q as Q,r as X,s as Y}from"./chunk-YL2U7DAQ.js";import{T as j,V as B,pa as O,ra as V,sa as U,ua as Z}from"./chunk-UA7J2MJT.js";import{a as N}from"./chunk-GPXQT2VE.js";import{Ja as m,La as p,Nb as k,Ob as F,P as E,Qb as H,S as w,Sa as M,Wa as a,Xa as o,Xb as q,Y as b,Ya as f,Za as _,_a as c,ab as C,ca as v,cc as A,d as y,da as x,db as S,ec as $,fb as g,mb as I,nb as r,pb as u,qb as P,sb as T,ua as l,ub as L,va as h,xb as D,yb as R,zb as z}from"./chunk-UIBI7PPD.js";var ge=(()=>{let i=class i{constructor(n){this._httpClient=n}getPortalLogs(n){return this._httpClient.get(N.PORTAL_LOGS,{params:ue(n)})}};i.\u0275fac=function(d){return new(d||i)(w(q))},i.\u0275prov=E({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var Ce=e=>({"sm:mb-18":e}),Se=e=>({"pointer-events-none":e});function Pe(e,i){if(e&1){let t=C();a(0,"button",15),S("click",function(){v(t);let d=g();return x(d.clearSearch())}),f(1,"mat-icon",16),a(2,"span"),r(3,"Clear Filter"),o()()}e&2&&(p("color","primary"),l(),p("svgIcon","heroicons_outline:x-mark"))}function Le(e,i){if(e&1&&(a(0,"fuse-alert",17),r(1),o()),e&2){let t=g();p("appearance","outline")("showIcon",!1)("type",t.alert.type)("@shake",t.alert.type==="error"),l(),u(" ",t.alert.message," ")}}function ye(e,i){e&1&&(a(0,"th",33),r(1," Performed By"),o())}function Ee(e,i){if(e&1&&(a(0,"td",34),r(1),o()),e&2){let t,n=i.$implicit;p("matTooltip",n.portal_user==null?null:n.portal_user.email),l(),u(" ",((t=n.portal_user==null?null:n.portal_user.name)!==null&&t!==void 0?t:n.portal_user==null?null:n.portal_user.email)||"-"," ")}}function we(e,i){e&1&&(a(0,"th",33),r(1," Endpoint"),o())}function be(e,i){if(e&1&&(a(0,"td",35),r(1),o()),e&2){let t=i.$implicit;l(),u(" ",t.endpoint||"-"," ")}}function Me(e,i){e&1&&(a(0,"th",33),r(1," Action"),o())}function Ie(e,i){if(e&1&&(a(0,"td",35),r(1),o()),e&2){let t=i.$implicit;l(),u(" ",t.action||"-"," ")}}function Te(e,i){e&1&&(a(0,"th",33),r(1," Device"),o())}function De(e,i){if(e&1&&(a(0,"td",35),r(1),o()),e&2){let t,n=i.$implicit;l(),u(" ",((t=(t=n.device==null?null:n.device.name)!==null&&t!==void 0?t:n.device==null?null:n.device.device_id)!==null&&t!==void 0?t:n.device==null?null:n.device.id)||"-"," ")}}function Re(e,i){e&1&&(a(0,"th",33),r(1," Device User"),o())}function ze(e,i){if(e&1&&(a(0,"td",35),r(1),o()),e&2){let t=i.$implicit;l(),u(" ",(t.device_user==null?null:t.device_user.device_username)||"-"," ")}}function ke(e,i){e&1&&(a(0,"th",33),r(1," User"),o())}function Fe(e,i){if(e&1&&(a(0,"td",35),r(1),o()),e&2){let t=i.$implicit;l(),P(" ",(t.user==null?null:t.user.name)||"-"," (",(t.user==null?null:t.user.email)||"-",") ")}}function He(e,i){e&1&&(a(0,"th",33),r(1," Shared User"),o())}function qe(e,i){if(e&1&&(a(0,"td",35),r(1),o()),e&2){let t=i.$implicit;l(),P(" ",(t.shared_user==null||t.shared_user.user==null?null:t.shared_user.user.name)||"-"," (",(t.shared_user==null||t.shared_user.user==null?null:t.shared_user.user.email)||"-",") ")}}function Ae(e,i){e&1&&(a(0,"th",33),r(1," Timestamp"),o())}function $e(e,i){if(e&1&&(a(0,"td",35),r(1),D(2,"date"),o()),e&2){let t=i.$implicit;l(),u(" ",R(2,1,t.timestamp,"medium")||"-"," ")}}function je(e,i){e&1&&f(0,"tr",36)}function Be(e,i){e&1&&f(0,"tr",37)}function Oe(e,i){if(e&1){let t=C();_(0),a(1,"table",18),_(2,19),m(3,ye,2,0,"th",20)(4,Ee,2,2,"td",21),c(),_(5,22),m(6,we,2,0,"th",20)(7,be,2,1,"td",23),c(),_(8,24),m(9,Me,2,0,"th",20)(10,Ie,2,1,"td",23),c(),_(11,25),m(12,Te,2,0,"th",20)(13,De,2,1,"td",23),c(),_(14,26),m(15,Re,2,0,"th",20)(16,ze,2,1,"td",23),c(),_(17,27),m(18,ke,2,0,"th",20)(19,Fe,2,2,"td",23),c(),_(20,28),m(21,He,2,0,"th",20)(22,qe,2,2,"td",23),c(),_(23,29),m(24,Ae,2,0,"th",20)(25,$e,3,4,"td",23),c(),m(26,je,1,0,"tr",30)(27,Be,1,0,"tr",31),o(),a(28,"mat-paginator",32),S("page",function(d){v(t);let s=g();return x(s.handlePageEvent(d))}),o(),c()}if(e&2){let t=g();l(),p("dataSource",t.portalLogs),l(25),p("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),l(),p("matRowDefColumns",t.displayedColumns),l(),p("ngClass",L(10,Se,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",t.pageSize)("showFirstLastButtons",!0)}}function Ve(e,i){e&1&&(a(0,"div",39),r(1," There are no portal logs! "),o())}function Ue(e,i){if(e&1&&m(0,Ve,2,0,"div",38),e&2){let t=g();p("ngIf",!t.isLoading)}}function Ne(e,i){e&1&&(_(0),a(1,"div",40),f(2,"mat-progress-spinner",41),a(3,"h4",42),r(4,"Fetching your portal logs..."),o()(),c())}var fe=(()=>{let i=class i{constructor(n,d,s){this._activatedRoute=n,this._router=d,this._sharedUsersService=s,this._subscription=new y,this.displayedColumns=["portal_user","endpoint","action","device","device_user","user","shared_user","timestamp"],this.pageSize=ce,this.pagination={length:0,page:0,size:this.pageSize[0]},this.alert={type:"success",message:""},this.showAlert=!1,this.isLoading=!1}ngOnInit(){this.pagination.tenant_id=this._activatedRoute.snapshot.queryParamMap.get("tenant_id"),this.pagination.zitadel_user_id=this._activatedRoute.snapshot.queryParamMap.get("zitadel_user_id"),this.pagination.device_id=this._activatedRoute.snapshot.queryParamMap.get("device_id"),this.pagination.device_user_id=this._activatedRoute.snapshot.queryParamMap.get("device_user_id"),this.pagination.shared_user_id=this._activatedRoute.snapshot.queryParamMap.get("shared_user_id"),this.pagination.portal_user_id=this._activatedRoute.snapshot.queryParamMap.get("portal_user_id"),this.pagination.page=Number(this._activatedRoute.snapshot.queryParamMap.get("page")??0),this.pagination.size=Number(this._activatedRoute.snapshot.queryParamMap.get("size")??this.pageSize[0]),this.isLoading=!0,this.getPortalLogs()}getPortalLogs(){this.isLoading=!0,this.queryParamHandler(),this._subscription.add(this._sharedUsersService.getPortalLogs(this.pagination).subscribe({next:n=>{this.portalLogs=n.items,this.pagination.length=n.total,this.isLoading=!1},error:n=>{n.status!==404&&this.onFailed(n.status===500?"500: Internal Server Error":n.error.detail),this.isLoading=!1}}))}clearSearch(){this.pagination.page=0,this.pagination.length=0,this.pagination.tenant_id=void 0,this.pagination.zitadel_user_id=void 0,this.pagination.device_user_id=void 0,this.pagination.device_id=void 0,this.pagination.shared_user_id=void 0,this.pagination.portal_user_id=void 0,this.getPortalLogs()}queryParamHandler(){this._router.navigate(["."],{relativeTo:this._activatedRoute,queryParams:{tenant_id:this.pagination.tenant_id,zitadel_user_id:this.pagination.zitadel_user_id,device_id:this.pagination.device_id,device_user_id:this.pagination.device_user_id,shared_user_id:this.pagination.shared_user_id,portal_user_id:this.pagination.portal_user_id,page:this.pagination.page,size:this.pagination.size}}).then()}handlePageEvent(n){this.pagination.length=n.length,this.pagination.size=n.pageSize,this.pagination.page=n.pageIndex,this.getPortalLogs()}onFailed(n){this.alert={type:"error",message:n},this.showAlert=!0,this.isLoading=!1}ngOnDestroy(){this._subscription?.unsubscribe()}};i.\u0275fac=function(d){return new(d||i)(h(A),h($),h(ge))},i.\u0275cmp=b({type:i,selectors:[["app-portal-logs"]],standalone:!0,features:[T],decls:17,vars:8,consts:[["noDevices",""],[1,"sm:absolute","sm:inset-0","flex","flex-col","flex-auto","min-w-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"border-b"],[1,"flex","flex-col","w-full","px-6"],[1,"flex","flex-col","sm:flex-row","flex-auto","sm:items-center","min-w-0","my-8"],[1,"flex","flex-auto","items-center","min-w-0"],[1,"flex","flex-col","min-w-0","ml-4"],["id","Clients",1,"text-2xl","md:text-5xl","font-semibold","tracking-tight","leading-7","md:leading-snug","truncate"],[1,"flex","items-center","mt-6","sm:mt-0","sm:ml-2","space-x-3"],["mat-stroked-button","",3,"color"],["class","mb-6",3,"appearance","showIcon","type",4,"ngIf"],[1,"relative","flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:overflow-y-auto",3,"ngClass"],[4,"ngIf","ngIfElse"],[4,"ngIf"],["mat-stroked-button","",3,"click","color"],[1,"icon-size-5",3,"svgIcon"],[1,"mb-6",3,"appearance","showIcon","type"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","portal_user"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"matTooltip",4,"matCellDef"],["matColumnDef","endpoint"],["mat-cell","",4,"matCellDef"],["matColumnDef","action"],["matColumnDef","device"],["matColumnDef","device_user"],["matColumnDef","user"],["matColumnDef","shared_user"],["matColumnDef","timestamp"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"page","ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],["mat-header-cell",""],["mat-cell","",3,"matTooltip"],["mat-cell",""],["mat-header-row",""],["mat-row",""],["class","p-8 sm:p-16 text-4xl font-semibold tracking-tight text-center",4,"ngIf"],[1,"p-8","sm:p-16","text-4xl","font-semibold","tracking-tight","text-center"],[1,"w-full","h-full","flex","flex-col","justify-center","items-center","bg-default"],["color","primary","diameter","50","strokeWidth","5","mode","indeterminate"],[1,"mt-16"]],template:function(d,s){if(d&1&&(a(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7),r(7," Portal Logs "),o()()(),a(8,"div",8),m(9,Pe,4,2,"button",9),o()(),m(10,Le,2,5,"fuse-alert",10),o()(),a(11,"div",11)(12,"div",12),m(13,Oe,29,12,"ng-container",13)(14,Ue,1,1,"ng-template",null,0,z)(16,Ne,5,0,"ng-container",14),o()()()),d&2){let he=I(15);l(9),M(s.pagination.tenant_id||s.pagination.zitadel_user_id||s.pagination.device_user_id||s.pagination.device_id||s.pagination.shared_user_id||s.pagination.portal_user_id?9:-1),l(),p("ngIf",!s.isLoading&&s.showAlert),l(2),p("ngClass",L(6,Ce,(s.portalLogs==null?null:s.portalLogs.length)>0)),l(),p("ngIf",(s.portalLogs==null?null:s.portalLogs.length)>0)("ngIfElse",he),l(3),p("ngIf",s.isLoading&&!s.portalLogs)}},dependencies:[Y,O,U,V,K,te,ee,X,Q,W,G,F,J,B,j,k,_e,ie,ae,se,oe,ne,me,re,le,pe,de,H],data:{animation:Z}});let e=i;return e})();var vt=[{path:"",component:fe}];export{vt as default};

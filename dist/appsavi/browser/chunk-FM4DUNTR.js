import{a as ot}from"./chunk-EV3FCACM.js";import{b as G,c as W,d as Z,e as J,f as K,g as Q,h as U,i as X,j as Y,k as tt,l as et,m as nt,n as it,o as at}from"./chunk-N4EAPRBL.js";import{w as q}from"./chunk-HM5AIPJZ.js";import{n as j,p as B,q as N,r as O,s as V}from"./chunk-YL2U7DAQ.js";import{V as L,pa as H,sa as A,ua as $}from"./chunk-UA7J2MJT.js";import"./chunk-GPXQT2VE.js";import{Ja as p,La as m,Nb as D,Ob as R,Qb as z,Wa as i,Xa as a,Y as C,Ya as h,Za as c,_a as u,ab as k,ca as v,cc as F,d as x,da as T,db as y,ec as P,fb as g,mb as w,nb as r,pb as f,sb as b,ua as s,ub as S,va as _,xb as M,yb as E,zb as I}from"./chunk-UIBI7PPD.js";var lt=t=>({"sm:mb-18":t}),mt=t=>({"pointer-events-none":t});function pt(t,e){if(t&1&&(i(0,"fuse-alert",13),r(1),a()),t&2){let n=g();m("appearance","outline")("showIcon",!1)("type",n.alert.type)("@shake",n.alert.type==="error"),s(),f(" ",n.alert.message," ")}}function dt(t,e){t&1&&(i(0,"th",25),r(1," Id"),a())}function ct(t,e){if(t&1&&(i(0,"td",26),r(1),a()),t&2){let n=e.$implicit;s(),f(" ",n.id||"-"," ")}}function ut(t,e){t&1&&(i(0,"th",25),r(1," Status"),a())}function ft(t,e){if(t&1&&(i(0,"td",26),r(1),a()),t&2){let n=e.$implicit;s(),f(" ",n.status||"-"," ")}}function gt(t,e){t&1&&(i(0,"th",25),r(1," Task Type"),a())}function _t(t,e){if(t&1&&(i(0,"td",26),r(1),a()),t&2){let n=e.$implicit;s(),f(" ",n.task_type||"-"," ")}}function ht(t,e){t&1&&(i(0,"th",25),r(1," Message"),a())}function St(t,e){if(t&1&&(i(0,"td",26),r(1),a()),t&2){let n=e.$implicit;s(),f(" ",n.message||"-"," ")}}function xt(t,e){t&1&&(i(0,"th",25),r(1," Created At"),a())}function Ct(t,e){if(t&1&&(i(0,"td",26),r(1),M(2,"date"),a()),t&2){let n=e.$implicit;s(),f(" ",E(2,1,n.created_at,"medium")||"-"," ")}}function vt(t,e){t&1&&h(0,"tr",27)}function Tt(t,e){t&1&&h(0,"tr",28)}function kt(t,e){if(t&1){let n=k();c(0),i(1,"table",14),c(2,15),p(3,dt,2,0,"th",16)(4,ct,2,1,"td",17),u(),c(5,18),p(6,ut,2,0,"th",16)(7,ft,2,1,"td",17),u(),c(8,19),p(9,gt,2,0,"th",16)(10,_t,2,1,"td",17),u(),c(11,20),p(12,ht,2,0,"th",16)(13,St,2,1,"td",17),u(),c(14,21),p(15,xt,2,0,"th",16)(16,Ct,3,4,"td",17),u(),p(17,vt,1,0,"tr",22)(18,Tt,1,0,"tr",23),a(),i(19,"mat-paginator",24),y("page",function(d){v(n);let l=g();return T(l.handlePageEvent(d))}),a(),u()}if(t&2){let n=g();s(),m("dataSource",n.taskStatuses),s(16),m("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),s(),m("matRowDefColumns",n.displayedColumns),s(),m("ngClass",S(10,mt,n.isLoading))("length",n.pagination.length)("pageIndex",n.pagination.page)("pageSize",n.pagination.size)("pageSizeOptions",n.pageSize)("showFirstLastButtons",!0)}}function yt(t,e){t&1&&(i(0,"div",30),r(1," There are no tasks! "),a())}function wt(t,e){if(t&1&&p(0,yt,2,0,"div",29),t&2){let n=g();m("ngIf",!n.isLoading)}}function bt(t,e){t&1&&(c(0),i(1,"div",31),h(2,"mat-progress-spinner",32),i(3,"h4",33),r(4,"Fetching your tasks..."),a()(),u())}var st=(()=>{let e=class e{constructor(o,d,l){this._activatedRoute=o,this._router=d,this._taskStatusService=l,this._subscription=new x,this.displayedColumns=["id","status","task_type","message","created_at"],this.pageSize=at,this.pagination={length:0,page:0,size:this.pageSize[0]},this.alert={type:"success",message:""},this.showAlert=!1,this.isLoading=!1}ngOnInit(){this.pagination.page=Number(this._activatedRoute.snapshot.queryParamMap.get("page")??0),this.pagination.size=Number(this._activatedRoute.snapshot.queryParamMap.get("size")??this.pageSize[0]),this.isLoading=!0,this.getTaskStatuses()}getTaskStatuses(){this.isLoading=!0,this.queryParamHandler(),this._subscription.add(this._taskStatusService.getTaskStatuses(this.pagination).subscribe({next:o=>{this.taskStatuses=o.items,this.pagination.length=o.total,this.isLoading=!1},error:o=>{o.status!==404&&this.onFailed(o.status===500?"500: Internal Server Error":o.error.detail),this.isLoading=!1}}))}queryParamHandler(){this._router.navigate(["."],{relativeTo:this._activatedRoute,queryParams:{page:this.pagination.page,size:this.pagination.size}}).then()}handlePageEvent(o){this.pagination.length=o.length,this.pagination.size=o.pageSize,this.pagination.page=o.pageIndex,this.getTaskStatuses()}onFailed(o){this.alert={type:"error",message:o},this.showAlert=!0,this.isLoading=!1}ngOnDestroy(){this._subscription?.unsubscribe()}};e.\u0275fac=function(d){return new(d||e)(_(F),_(P),_(ot))},e.\u0275cmp=C({type:e,selectors:[["app-task-status"]],standalone:!0,features:[b],decls:15,vars:7,consts:[["noDevices",""],[1,"sm:absolute","sm:inset-0","flex","flex-col","flex-auto","min-w-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"border-b"],[1,"flex","flex-col","w-full","px-6"],[1,"flex","flex-col","sm:flex-row","flex-auto","sm:items-center","min-w-0","my-8"],[1,"flex","flex-auto","items-center","min-w-0"],[1,"flex","flex-col","min-w-0","ml-4"],["id","Clients",1,"text-2xl","md:text-5xl","font-semibold","tracking-tight","leading-7","md:leading-snug","truncate"],["class","mb-6",3,"appearance","showIcon","type",4,"ngIf"],[1,"relative","flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:overflow-y-auto",3,"ngClass"],[4,"ngIf","ngIfElse"],[4,"ngIf"],[1,"mb-6",3,"appearance","showIcon","type"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","status"],["matColumnDef","task_type"],["matColumnDef","message"],["matColumnDef","created_at"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"page","ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],["class","p-8 sm:p-16 text-4xl font-semibold tracking-tight text-center",4,"ngIf"],[1,"p-8","sm:p-16","text-4xl","font-semibold","tracking-tight","text-center"],[1,"w-full","h-full","flex","flex-col","justify-center","items-center","bg-default"],["color","primary","diameter","50","strokeWidth","5","mode","indeterminate"],[1,"mt-16"]],template:function(d,l){if(d&1&&(i(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7),r(7," Task Status "),a()()()(),p(8,pt,2,5,"fuse-alert",8),a()(),i(9,"div",9)(10,"div",10),p(11,kt,20,12,"ng-container",11)(12,wt,1,1,"ng-template",null,0,I)(14,bt,5,0,"ng-container",12),a()()()),d&2){let rt=w(13);s(8),m("ngIf",!l.isLoading&&l.showAlert),s(2),m("ngClass",S(5,lt,(l.taskStatuses==null?null:l.taskStatuses.length)>0)),s(),m("ngIf",(l.taskStatuses==null?null:l.taskStatuses.length)>0)("ngIfElse",rt),s(3),m("ngIf",l.isLoading&&!l.taskStatuses)}},dependencies:[V,H,A,B,W,G,O,N,q,R,j,L,D,it,Z,K,Y,Q,J,tt,U,X,et,nt,z],data:{animation:$}});let t=e;return t})();var Kt=[{path:"",component:st}];export{Kt as default};

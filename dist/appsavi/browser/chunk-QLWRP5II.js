import{a as pe}from"./chunk-NWPAM2UG.js";import{b as q}from"./chunk-VNFDGEEB.js";import{b as X,c as Y,d as ee,e as te,f as ie,g as ne,h as ae,i as re,j as oe,k as se,l as le,m as me,n as ce,o as de}from"./chunk-N4EAPRBL.js";import{j as $}from"./chunk-JNRCB37G.js";import{v as j,w as N}from"./chunk-HM5AIPJZ.js";import{a as w}from"./chunk-GMUQQUFC.js";import{n as W,p as Z,q as J,r as K,s as Q}from"./chunk-YL2U7DAQ.js";import{T as V,U as F,V as A,pa as H,ra as B,sa as O,ua as G}from"./chunk-UA7J2MJT.js";import"./chunk-GPXQT2VE.js";import{Ja as d,La as m,Nb as z,Ob as L,Sa as T,Wa as r,Xa as o,Y as M,Ya as _,Za as u,_a as h,ab as x,ca as g,cc as P,d as E,da as f,db as S,ec as U,fb as p,mb as D,nb as c,pb as C,qb as y,sb as k,ua as l,ub as I,va as v,zb as R}from"./chunk-UIBI7PPD.js";var ge=e=>({"sm:mb-18":e}),fe=e=>({"pointer-events-none":e});function ve(e,a){if(e&1){let t=x();r(0,"button",15),S("click",function(){g(t);let n=p();return f(n.clearSearch())}),_(1,"mat-icon",16),r(2,"span"),c(3,"Clear Filter"),o()()}e&2&&(m("color","primary"),l(),m("svgIcon","heroicons_outline:x-mark"))}function Se(e,a){if(e&1&&(r(0,"fuse-alert",17),c(1),o()),e&2){let t=p();m("appearance","outline")("showIcon",!1)("type",t.alert.type)("@shake",t.alert.type==="error"),l(),C(" ",t.alert.message," ")}}function xe(e,a){e&1&&(r(0,"th",29),c(1," Device"),o())}function Ce(e,a){if(e&1&&(r(0,"td",30),c(1),o()),e&2){let t,i=a.$implicit;l(),C(" ",((t=i.device.name)!==null&&t!==void 0?t:i.device.device_id)||"-"," ")}}function we(e,a){e&1&&(r(0,"th",29),c(1," Device User"),o())}function be(e,a){if(e&1&&(r(0,"td",30),c(1),o()),e&2){let t=a.$implicit;l(),C(" ",t.device_user.device_username||"-"," ")}}function ye(e,a){e&1&&(r(0,"th",29),c(1," Shared User"),o())}function Ie(e,a){if(e&1&&(r(0,"td",30),c(1),o()),e&2){let t=a.$implicit;l(),y(" ",t.user.name||"-"," (",t.user.email||"-",") ")}}function Ue(e,a){e&1&&(r(0,"th",29),c(1," Owner Users"),o())}function Ee(e,a){if(e&1&&(r(0,"td",30),c(1),o()),e&2){let t=a.$implicit;l(),y(" ",(t.device_user==null||t.device_user.user==null?null:t.device_user.user.name)||"-"," (",(t.device_user==null||t.device_user.user==null?null:t.device_user.user.email)||"-",") ")}}function Me(e,a){e&1&&(r(0,"th",29),c(1," Action"),o())}function Te(e,a){if(e&1){let t=x();r(0,"td",30)(1,"button",31),S("click",function(){let n=g(t).$implicit,s=p(2);return f(s.viewDeviceUser(n.device_user.id))}),_(2,"mat-icon",16),o(),r(3,"button",32),S("click",function(){let n=g(t).$implicit,s=p(2);return f(s.viewDeviceLogs(n==null||n.user==null?null:n.user.id,n==null||n.device_user==null?null:n.device_user.id))}),_(4,"mat-icon",16),o(),r(5,"button",33),S("click",function(){let n=g(t).$implicit,s=p(2);return f(s.viewAdminLogs(n.id))}),_(6,"mat-icon",16),o(),r(7,"button",34),S("click",function(){let n=g(t).$implicit,s=p(2);return f(s.deleteConfirmation(n))}),_(8,"mat-icon",35),o()()}e&2&&(l(2),m("svgIcon","mat_outline:devices"),l(2),m("svgIcon","mat_outline:screen_search_desktop"),l(2),m("svgIcon","mat_outline:manage_search"),l(2),m("svgIcon","heroicons_outline:trash"))}function De(e,a){e&1&&_(0,"tr",36)}function ke(e,a){e&1&&_(0,"tr",37)}function Re(e,a){if(e&1){let t=x();u(0),r(1,"table",18),u(2,19),d(3,xe,2,0,"th",20)(4,Ce,2,1,"td",21),h(),u(5,22),d(6,we,2,0,"th",20)(7,be,2,1,"td",21),h(),u(8,23),d(9,ye,2,0,"th",20)(10,Ie,2,2,"td",21),h(),u(11,24),d(12,Ue,2,0,"th",20)(13,Ee,2,2,"td",21),h(),u(14,25),d(15,Me,2,0,"th",20)(16,Te,9,4,"td",21),h(),d(17,De,1,0,"tr",26)(18,ke,1,0,"tr",27),o(),r(19,"mat-paginator",28),S("page",function(n){g(t);let s=p();return f(s.handlePageEvent(n))}),o(),h()}if(e&2){let t=p();l(),m("dataSource",t.devices),l(16),m("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),l(),m("matRowDefColumns",t.displayedColumns),l(),m("ngClass",I(10,fe,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",t.pageSize)("showFirstLastButtons",!0)}}function ze(e,a){e&1&&(r(0,"div",39),c(1," There are no devices! "),o())}function Le(e,a){if(e&1&&d(0,ze,2,0,"div",38),e&2){let t=p();m("ngIf",!t.isLoading)}}function Pe(e,a){e&1&&(u(0),r(1,"div",40),_(2,"mat-progress-spinner",41),r(3,"h4",42),c(4,"Fetching your devices..."),o()(),h())}var _e=(()=>{let a=class a{constructor(i,n,s,b,ue,he){this._snackBar=i,this._activatedRoute=n,this._fuseConfirmationService=s,this._router=b,this._sharedUsersService=ue,this.router=he,this._subscription=new E,this.displayedColumns=["device","device_user","shared_user","owner_user","action"],this.pageSize=de,this.pagination={length:0,page:0,size:this.pageSize[0]},this.alert={type:"success",message:""},this.showAlert=!1,this.isLoading=!1}ngOnInit(){this.pagination.tenant_id=this._activatedRoute.snapshot.queryParamMap.get("tenant_id"),this.pagination.zitadel_user_id=this._activatedRoute.snapshot.queryParamMap.get("zitadel_user_id"),this.pagination.device_user_id=this._activatedRoute.snapshot.queryParamMap.get("device_user_id"),this.pagination.page=Number(this._activatedRoute.snapshot.queryParamMap.get("page")??0),this.pagination.size=Number(this._activatedRoute.snapshot.queryParamMap.get("size")??this.pageSize[0]),this.isLoading=!0,this.getSharedUsers()}getSharedUsers(){this.isLoading=!0,this.queryParamHandler(),this._subscription.add(this._sharedUsersService.getSharedUsers(this.pagination).subscribe({next:i=>{this.devices=i.items,this.pagination.length=i.total,this.isLoading=!1},error:i=>{i.status!==404&&this.onFailed(i.status===500?"500: Internal Server Error":i.error.detail),this.isLoading=!1}}))}clearSearch(){this.pagination.page=0,this.pagination.length=0,this.pagination.tenant_id=void 0,this.pagination.zitadel_user_id=void 0,this.pagination.device_user_id=void 0,this.getSharedUsers()}queryParamHandler(){this._router.navigate(["."],{relativeTo:this._activatedRoute,queryParams:{tenant_id:this.pagination.tenant_id,zitadel_user_id:this.pagination.zitadel_user_id,device_user_id:this.pagination.device_user_id,page:this.pagination.page,size:this.pagination.size}}).then()}handlePageEvent(i){this.pagination.length=i.length,this.pagination.size=i.pageSize,this.pagination.page=i.pageIndex,this.getSharedUsers()}deleteConfirmation(i){this._subscription.add(this._fuseConfirmationService.open({title:"Remove this shared user",message:"Are you sure you want to remove this user permanently?",icon:{show:!0,name:"heroicons_outline:exclamation-triangle",color:"warn"},actions:{confirm:{show:!0,label:"Remove",color:"warn"},cancel:{show:!0,label:"Cancel"}},dismissible:!0}).afterClosed().subscribe(n=>{n==="confirmed"&&this.deleteSharedUser(i)}))}deleteSharedUser(i){this.isLoading=!0,this.showAlert=!1,this._subscription.add(this._sharedUsersService.deleteShareUser(i.id).subscribe({next:()=>{this._snackBar.open("Removed successfully.!"),this.getSharedUsers()},error:n=>this.onFailed(n.status===500?"500: Internal Server Error":n.error)}))}viewDeviceUser(i){this.router.navigate([w.DEVICE_USERS],{queryParams:{device_id:i}}).then()}viewAdminLogs(i){this.router.navigate([w.PORTAL_LOGS],{queryParams:{shared_user_id:i}}).then()}viewDeviceLogs(i,n){this.router.navigate([w.DEVICE_LOGS],{queryParams:{zitadel_user_id:i,device_user_id:n}}).then()}onFailed(i){this.alert={type:"error",message:i},this.showAlert=!0,this.isLoading=!1}ngOnDestroy(){this._subscription?.unsubscribe()}};a.\u0275fac=function(n){return new(n||a)(v(q),v(P),v($),v(U),v(pe),v(U))},a.\u0275cmp=M({type:a,selectors:[["app-shared-users"]],standalone:!0,features:[k],decls:17,vars:8,consts:[["noDevices",""],[1,"sm:absolute","sm:inset-0","flex","flex-col","flex-auto","min-w-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"border-b"],[1,"flex","flex-col","w-full","px-6"],[1,"flex","flex-col","sm:flex-row","flex-auto","sm:items-center","min-w-0","my-8"],[1,"flex","flex-auto","items-center","min-w-0"],[1,"flex","flex-col","min-w-0","ml-4"],["id","Clients",1,"text-2xl","md:text-5xl","font-semibold","tracking-tight","leading-7","md:leading-snug","truncate"],[1,"flex","items-center","mt-6","sm:mt-0","sm:ml-2","space-x-3"],["mat-stroked-button","",3,"color"],["class","mb-6",3,"appearance","showIcon","type",4,"ngIf"],[1,"relative","flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:overflow-y-auto",3,"ngClass"],[4,"ngIf","ngIfElse"],[4,"ngIf"],["mat-stroked-button","",3,"click","color"],[1,"icon-size-5",3,"svgIcon"],[1,"mb-6",3,"appearance","showIcon","type"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","device"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","device_user"],["matColumnDef","shared_user"],["matColumnDef","owner_user"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"page","ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","matTooltip","view device users",3,"click"],["mat-icon-button","","matTooltip","view device logs",3,"click"],["mat-icon-button","","matTooltip","view portal logs",3,"click"],["mat-icon-button","","matTooltip","remove",3,"click"],[1,"icon-size-5","text-red-500",3,"svgIcon"],["mat-header-row",""],["mat-row",""],["class","p-8 sm:p-16 text-4xl font-semibold tracking-tight text-center",4,"ngIf"],[1,"p-8","sm:p-16","text-4xl","font-semibold","tracking-tight","text-center"],[1,"w-full","h-full","flex","flex-col","justify-center","items-center","bg-default"],["color","primary","diameter","50","strokeWidth","5","mode","indeterminate"],[1,"mt-16"]],template:function(n,s){if(n&1&&(r(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7),c(7," Shared Users "),o()()(),r(8,"div",8),d(9,ve,4,2,"button",9),o()(),d(10,Se,2,5,"fuse-alert",10),o()(),r(11,"div",11)(12,"div",12),d(13,Re,20,12,"ng-container",13)(14,Le,1,1,"ng-template",null,0,R)(16,Pe,5,0,"ng-container",14),o()()()),n&2){let b=D(15);l(9),T(s.pagination.zitadel_user_id||s.pagination.device_user_id||s.pagination.tenant_id?9:-1),l(),m("ngIf",!s.isLoading&&s.showAlert),l(2),m("ngClass",I(6,ge,(s.devices==null?null:s.devices.length)>0)),l(),m("ngIf",(s.devices==null?null:s.devices.length)>0)("ngIfElse",b),l(3),m("ngIf",s.isLoading&&!s.devices)}},dependencies:[Q,H,O,B,Z,Y,X,K,J,N,j,L,W,A,V,F,z,ce,ee,ie,oe,ne,te,se,ae,re,le,me],data:{animation:G}});let e=a;return e})();var ct=[{path:"",component:_e}];export{ct as default};

import{b as ge,c as he,d as xe,e as Ce,f as be,g as De,h as we,i as Se,j as Ie,k as ye,l as Ee,m as Me,n as Te,o as ke,p as Fe}from"./chunk-N4EAPRBL.js";import{a as Y,b as ee,c as te,j as ae}from"./chunk-JNRCB37G.js";import{v as se,w as le}from"./chunk-HM5AIPJZ.js";import{a as D}from"./chunk-GMUQQUFC.js";import{b as me,d as O,f as ce,g as de,i as pe,j as ue,k as _e,l as fe,n as A,o as ve,p as P,q as N,r as j,s as q}from"./chunk-YL2U7DAQ.js";import{T,U as k,V as F,ia as ie,ja as ne,oa as oe,pa as re,ra as R,sa as L,ua as z}from"./chunk-UA7J2MJT.js";import{a as V}from"./chunk-IUWJHV3G.js";import{Ja as p,La as m,Nb as K,Ob as M,P as U,S as G,Sa as Z,Wa as r,Xa as a,Xb as Q,Y as S,Ya as d,Za as x,_a as C,ab as I,ca as v,cc as X,d as w,da as g,db as f,ec as B,fb as u,mb as W,nb as c,ob as y,pb as b,sb as E,ua as l,ub as $,va as _,zb as J}from"./chunk-UIBI7PPD.js";var H=(()=>{let i=class i{constructor(t){this._httpClient=t}getDevices(t){return this._httpClient.get(V.DEVICES,{params:Fe(t)})}updateDevice(t,o){return this._httpClient.patch(`${V.DEVICES}${t}`,o)}deleteDevice(t){return this._httpClient.delete(`${V.DEVICES}${t}`)}};i.\u0275fac=function(o){return new(o||i)(G(Q))},i.\u0275prov=U({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();function $e(e,i){if(e&1&&(r(0,"fuse-alert",16),c(1),a()),e&2){let s=u();m("appearance","outline")("showIcon",!1)("type",s.alert.type)("@shake",s.alert.type==="error"),l(),b(" ",s.alert.message," ")}}function Be(e,i){e&1&&(r(0,"mat-error"),c(1," Name is required "),a())}function Oe(e,i){e&1&&(r(0,"mat-error"),c(1," Device Id is required "),a())}function Ue(e,i){e&1&&(r(0,"span"),c(1," Save "),a())}function Ge(e,i){e&1&&d(0,"mat-progress-spinner",17),e&2&&m("diameter",24)("mode","indeterminate")}var Ve=(()=>{let i=class i{constructor(t,o,n,h){this._formBuilder=t,this.devicesService=o,this.matDialogRef=n,this.data=h,this.subscription=new w,this.alert={type:"success",message:""},this.showAlert=!1,this.isLoading=!1}ngOnInit(){this.createForm=this._formBuilder.group({id:[this.data?.id??"",[O.required]],name:[this.data?.name??"",[O.required]],device_id:[this.data?.device_id??""]})}save(){this.createForm.invalid||(this.showAlert=!1,this.isLoading=!0,this.data&&this.subscription.add(this.devicesService.updateDevice(this.data.id,this.createForm.value).subscribe({next:()=>this.matDialogRef.close(!0),error:t=>{this.onFailed(t.error.detail??t.statusText)}})))}onFailed(t){this.alert={type:"error",message:t},this.showAlert=!0,this.isLoading=!1,this.createForm.enable()}ngOnDestroy(){this.subscription?.unsubscribe()}};i.\u0275fac=function(o){return new(o||i)(_(fe),_(H),_(Y),_(ee))},i.\u0275cmp=S({type:i,selectors:[["app-device"]],standalone:!0,features:[E],decls:23,vars:13,consts:[[1,"flex","flex-col","flex-auto","md:w-160","md:min-w-160","max-h-160","-m-6","overflow-y-auto"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","",3,"click","tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","w-full","p-6","sm:p-8","overflow-y-auto"],["class","mb-4",3,"appearance","showIcon","type",4,"ngIf"],[3,"formGroup"],[1,"w-full","mb-2"],["id","name","matInput","","placeholder","Enter Name",3,"formControlName"],[4,"ngIf"],[1,"w-full"],["id","address_1","matInput","","readonly","","placeholder","Enter device Id",3,"formControlName"],[1,"flex","justify-end"],["mat-flat-button","",1,"fuse-mat-button-large","mt-3",3,"click","color","disabled"],[3,"diameter","mode",4,"ngIf"],[1,"mb-4",3,"appearance","showIcon","type"],[3,"diameter","mode"]],template:function(o,n){o&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),c(3),a(),r(4,"button",3),f("click",function(){return n.matDialogRef.close()}),d(5,"mat-icon",4),a()(),r(6,"div",5),p(7,$e,2,5,"fuse-alert",6),r(8,"form",7)(9,"mat-form-field",8)(10,"mat-label"),c(11,"Name"),a(),d(12,"input",9),p(13,Be,2,0,"mat-error",10),a(),r(14,"mat-form-field",11)(15,"mat-label"),c(16,"Device Id"),a(),d(17,"input",12),p(18,Oe,2,0,"mat-error",10),a(),r(19,"div",13)(20,"button",14),f("click",function(){return n.save()}),p(21,Ue,2,0,"span",10)(22,Ge,1,2,"mat-progress-spinner",15),a()()()()()),o&2&&(l(3),b("",n.data?"Edit":"New"," Device"),l(),m("tabIndex",-1),l(),m("svgIcon","heroicons_outline:x-mark"),l(2),m("ngIf",n.showAlert),l(),m("formGroup",n.createForm),l(4),m("formControlName","name"),l(),m("ngIf",n.createForm.get("name").hasError("required")),l(4),m("formControlName","device_id"),l(),m("ngIf",n.createForm.get("device_id").hasError("required")),l(2),m("color","primary")("disabled",n.createForm.disabled||n.isLoading),l(),m("ngIf",!n.createForm.disabled&&!n.isLoading),l(),m("ngIf",n.createForm.disabled||n.isLoading))},dependencies:[A,pe,me,ce,de,ue,_e,q,P,ve,oe,ie,ne,j,N,F,T,k,L,R,M],data:{animation:z}});let e=i;return e})();var Ze=e=>({"sm:mb-18":e}),We=e=>({"pointer-events-none":e});function Je(e,i){if(e&1){let s=I();r(0,"button",15),f("click",function(){v(s);let o=u();return g(o.clearSearch())}),d(1,"mat-icon",16),r(2,"span"),c(3,"Clear Filter"),a()()}e&2&&(m("color","primary"),l(),m("svgIcon","heroicons_outline:x-mark"))}function Ke(e,i){if(e&1&&(r(0,"fuse-alert",17),c(1),a()),e&2){let s=u();m("appearance","outline")("showIcon",!1)("type",s.alert.type)("@shake",s.alert.type==="error"),l(),b(" ",s.alert.message," ")}}function Qe(e,i){e&1&&(r(0,"th",28),c(1," Name"),a())}function Xe(e,i){if(e&1&&(r(0,"td",29),c(1),a()),e&2){let s=i.$implicit;l(),y(s.name||"-")}}function Ye(e,i){e&1&&(r(0,"th",28),c(1," Device Id"),a())}function et(e,i){if(e&1&&(r(0,"td",29),c(1),a()),e&2){let s=i.$implicit;l(),y(s.device_id||"-")}}function tt(e,i){e&1&&(r(0,"th",28),c(1," Device Users"),a())}function it(e,i){if(e&1&&(r(0,"td",29),c(1),a()),e&2){let s=i.$implicit;l(),y(s.len_device_users||"-")}}function nt(e,i){e&1&&(r(0,"th",28),c(1," Action"),a())}function ot(e,i){if(e&1){let s=I();r(0,"td",29)(1,"button",30),f("click",function(){let o=v(s).$implicit,n=u(2);return g(n.viewDeviceUser(o.id))}),d(2,"mat-icon",16),a(),r(3,"button",31),f("click",function(){let o=v(s).$implicit,n=u(2);return g(n.viewSharedUser(o.id))}),d(4,"mat-icon",16),a(),r(5,"button",32),f("click",function(){let o=v(s).$implicit,n=u(2);return g(n.viewDeviceLogs(o.id))}),d(6,"mat-icon",16),a(),r(7,"button",33),f("click",function(){let o=v(s).$implicit,n=u(2);return g(n.viewAdminLogs(o.id))}),d(8,"mat-icon",16),a(),r(9,"button",34),f("click",function(){let o=v(s).$implicit,n=u(2);return g(n.openDeviceModal(o))}),d(10,"mat-icon",16),a(),r(11,"button",35),f("click",function(){let o=v(s).$implicit,n=u(2);return g(n.deleteConfirmation(o))}),d(12,"mat-icon",36),a()()}e&2&&(l(2),m("svgIcon","mat_outline:devices"),l(2),m("svgIcon","mat_outline:screen_share"),l(2),m("svgIcon","mat_outline:screen_search_desktop"),l(2),m("svgIcon","mat_outline:manage_search"),l(2),m("svgIcon","heroicons_outline:pencil"),l(2),m("svgIcon","heroicons_outline:trash"))}function rt(e,i){e&1&&d(0,"tr",37)}function at(e,i){e&1&&d(0,"tr",38)}function st(e,i){if(e&1){let s=I();x(0),r(1,"table",18),x(2,19),p(3,Qe,2,0,"th",20)(4,Xe,2,1,"td",21),C(),x(5,22),p(6,Ye,2,0,"th",20)(7,et,2,1,"td",21),C(),x(8,23),p(9,tt,2,0,"th",20)(10,it,2,1,"td",21),C(),x(11,24),p(12,nt,2,0,"th",20)(13,ot,13,6,"td",21),C(),p(14,rt,1,0,"tr",25)(15,at,1,0,"tr",26),a(),r(16,"mat-paginator",27),f("page",function(o){v(s);let n=u();return g(n.handlePageEvent(o))}),a(),C()}if(e&2){let s=u();l(),m("dataSource",s.devices),l(13),m("matHeaderRowDef",s.displayedColumns)("matHeaderRowDefSticky",!0),l(),m("matRowDefColumns",s.displayedColumns),l(),m("ngClass",$(10,We,s.isLoading))("length",s.pagination.length)("pageIndex",s.pagination.page)("pageSize",s.pagination.size)("pageSizeOptions",s.pageSize)("showFirstLastButtons",!0)}}function lt(e,i){e&1&&(r(0,"div",40),c(1," There are no devices! "),a())}function mt(e,i){if(e&1&&p(0,lt,2,0,"div",39),e&2){let s=u();m("ngIf",!s.isLoading)}}function ct(e,i){e&1&&(x(0),r(1,"div",41),d(2,"mat-progress-spinner",42),r(3,"h4",43),c(4,"Fetching your devices..."),a()(),C())}var ze=(()=>{let i=class i{constructor(t,o,n,h,Ae,Pe){this._activatedRoute=t,this._fuseConfirmationService=o,this._router=n,this._devicesService=h,this._matDialog=Ae,this.router=Pe,this._subscription=new w,this.displayedColumns=["name","device_id","len_device_users","action"],this.pageSize=ke,this.pagination={length:0,page:0,size:this.pageSize[0]},this.alert={type:"success",message:""},this.showAlert=!1,this.isLoading=!1}ngOnInit(){this.pagination.tenant_id=this._activatedRoute.snapshot.queryParamMap.get("tenant_id"),this.pagination.zitadel_user_id=this._activatedRoute.snapshot.queryParamMap.get("zitadel_user_id"),this.pagination.page=Number(this._activatedRoute.snapshot.queryParamMap.get("page")??0),this.pagination.size=Number(this._activatedRoute.snapshot.queryParamMap.get("size")??this.pageSize[0]),this.isLoading=!0,this.getDevices()}openDeviceModal(t=null){this._subscription.add(this._matDialog.open(Ve,{data:t,disableClose:!0}).afterClosed().subscribe({next:o=>{o&&this.getDevices()}}))}getDevices(){this.isLoading=!0,this.queryParamHandler(),this._subscription.add(this._devicesService.getDevices(this.pagination).subscribe({next:t=>{this.devices=t.items,this.pagination.length=t.total,this.isLoading=!1},error:t=>{t.status!==404&&this.onFailed(t.status===500?"500: Internal Server Error":t.error.detail),this.isLoading=!1}}))}clearSearch(){this.pagination.page=0,this.pagination.length=0,this.pagination.tenant_id=void 0,this.pagination.zitadel_user_id=void 0,this.getDevices()}queryParamHandler(){this._router.navigate(["."],{relativeTo:this._activatedRoute,queryParams:{tenant_id:this.pagination.tenant_id,zitadel_user_id:this.pagination.zitadel_user_id,page:this.pagination.page,size:this.pagination.size}}).then()}handlePageEvent(t){this.pagination.length=t.length,this.pagination.size=t.pageSize,this.pagination.page=t.pageIndex,this.getDevices()}deleteConfirmation(t){this._subscription.add(this._fuseConfirmationService.open({title:"Remove this device",message:"This will remove the users from the shared device as well as from any device users on the device.",icon:{show:!0,name:"heroicons_outline:exclamation-triangle",color:"warn"},actions:{confirm:{show:!0,label:"Remove",color:"warn"},cancel:{show:!0,label:"Cancel"}},dismissible:!0}).afterClosed().subscribe(o=>{o==="confirmed"&&this.deleteZitadelUser(t)}))}deleteZitadelUser(t){this.isLoading=!0,this.showAlert=!1,this._subscription.add(this._devicesService.deleteDevice(t.id).subscribe({next:()=>this.getDevices(),error:o=>this.onFailed(o.status===500?"500: Internal Server Error":o.error)}))}viewDeviceUser(t){this.router.navigate([D.DEVICE_USERS],{queryParams:{device_id:t}}).then()}viewSharedUser(t){this.router.navigate([D.SHARED_USERS],{queryParams:{device_id:t}}).then()}viewDeviceLogs(t){this.router.navigate([D.DEVICE_LOGS],{queryParams:{device_id:t}}).then()}viewAdminLogs(t){this.router.navigate([D.PORTAL_LOGS],{queryParams:{device_id:t}}).then()}onFailed(t){this.alert={type:"error",message:t},this.showAlert=!0,this.isLoading=!1}ngOnDestroy(){this._subscription?.unsubscribe()}};i.\u0275fac=function(o){return new(o||i)(_(X),_(ae),_(B),_(H),_(te),_(B))},i.\u0275cmp=S({type:i,selectors:[["app-devices"]],standalone:!0,features:[E],decls:17,vars:8,consts:[["noDevices",""],[1,"sm:absolute","sm:inset-0","flex","flex-col","flex-auto","min-w-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"border-b"],[1,"flex","flex-col","w-full","px-6"],[1,"flex","flex-col","sm:flex-row","flex-auto","sm:items-center","min-w-0","my-8"],[1,"flex","flex-auto","items-center","min-w-0"],[1,"flex","flex-col","min-w-0","ml-4"],["id","Clients",1,"text-2xl","md:text-5xl","font-semibold","tracking-tight","leading-7","md:leading-snug","truncate"],[1,"flex","items-center","mt-6","sm:mt-0","sm:ml-2","space-x-3"],["mat-stroked-button","",3,"color"],["class","mb-6",3,"appearance","showIcon","type",4,"ngIf"],[1,"relative","flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:overflow-y-auto",3,"ngClass"],[4,"ngIf","ngIfElse"],[4,"ngIf"],["mat-stroked-button","",3,"click","color"],[1,"icon-size-5",3,"svgIcon"],[1,"mb-6",3,"appearance","showIcon","type"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","device_id"],["matColumnDef","len_device_users"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"page","ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","matTooltip","view device users",3,"click"],["mat-icon-button","","matTooltip","view shared users",3,"click"],["mat-icon-button","","matTooltip","view device logs",3,"click"],["mat-icon-button","","matTooltip","view portal logs",3,"click"],["mat-icon-button","","matTooltip","edit",3,"click"],["mat-icon-button","","matTooltip","delete",3,"click"],[1,"icon-size-5","text-red-500",3,"svgIcon"],["mat-header-row",""],["mat-row",""],["class","p-8 sm:p-16 text-4xl font-semibold tracking-tight text-center",4,"ngIf"],[1,"p-8","sm:p-16","text-4xl","font-semibold","tracking-tight","text-center"],[1,"w-full","h-full","flex","flex-col","justify-center","items-center","bg-default"],["color","primary","diameter","50","strokeWidth","5","mode","indeterminate"],[1,"mt-16"]],template:function(o,n){if(o&1&&(r(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7),c(7," Devices "),a()()(),r(8,"div",8),p(9,Je,4,2,"button",9),a()(),p(10,Ke,2,5,"fuse-alert",10),a()(),r(11,"div",11)(12,"div",12),p(13,st,17,12,"ng-container",13)(14,mt,1,1,"ng-template",null,0,J)(16,ct,5,0,"ng-container",14),a()()()),o&2){let h=W(15);l(9),Z(n.pagination.tenant_id||n.pagination.zitadel_user_id?9:-1),l(),m("ngIf",!n.isLoading&&n.showAlert),l(2),m("ngClass",$(6,Ze,(n.devices==null?null:n.devices.length)>0)),l(),m("ngIf",(n.devices==null?null:n.devices.length)>0)("ngIfElse",h),l(3),m("ngIf",n.isLoading&&!n.devices)}},dependencies:[q,re,L,R,P,he,ge,j,N,le,se,M,A,F,T,k,K,Te,xe,be,Ie,De,Ce,ye,we,Se,Ee,Me],data:{animation:z}});let e=i;return e})();var Qt=[{path:"",component:ze}];export{Qt as default};

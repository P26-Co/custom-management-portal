import{a as me}from"./chunk-YU27UCT7.js";import{b as J,c as K,d as Q,e as X,f as Y,g as ee,h as te,i as ie,j as ne,k as ae,l as oe,m as re,n as se,o as le}from"./chunk-HTYTCO3U.js";import{j as H}from"./chunk-3KNKVKUA.js";import{v as q,w as $}from"./chunk-NMNUGWFG.js";import{a as w}from"./chunk-7D2E4VF2.js";import{n as N,p as O,q as B,r as G,s as W}from"./chunk-OVEWZQON.js";import{U as L,V as F,pa as P,ra as V,sa as A,ua as j}from"./chunk-33VKULNV.js";import"./chunk-EYZSRIIE.js";import{Ab as Z,Ja as c,La as m,Ob as D,Pb as k,Wa as a,Xa as o,Y as E,Ya as _,Za as u,_a as f,ab as b,ca as g,d as U,da as h,db as x,dc as R,fb as p,fc as I,mb as z,nb as d,ob as C,pb as M,sb as T,ua as l,ub as y,va as v}from"./chunk-IB225IHQ.js";var pe=e=>({"sm:mb-18":e}),_e=e=>({"pointer-events-none":e});function ue(e,n){if(e&1&&(a(0,"fuse-alert",13),d(1),o()),e&2){let i=p();m("appearance","outline")("showIcon",!1)("type",i.alert.type)("@shake",i.alert.type==="error"),l(),M(" ",i.alert.message," ")}}function fe(e,n){e&1&&(a(0,"th",25),d(1," Name"),o())}function ge(e,n){if(e&1&&(a(0,"td",26),d(1),o()),e&2){let i=n.$implicit;l(),C(i.name)}}function he(e,n){e&1&&(a(0,"th",25),d(1," Email"),o())}function ve(e,n){if(e&1&&(a(0,"td",26),d(1),o()),e&2){let i=n.$implicit;l(),C(i.email||"-")}}function xe(e,n){e&1&&(a(0,"th",25),d(1," Zitadel User Id"),o())}function Ce(e,n){if(e&1&&(a(0,"td",26),d(1),o()),e&2){let i=n.$implicit;l(),C(i.zitadel_user_id||"-")}}function we(e,n){e&1&&(a(0,"th",25),d(1," Tenant Id"),o())}function Se(e,n){if(e&1&&(a(0,"td",26),d(1),o()),e&2){let i=n.$implicit;l(),C(i.tenant_id||"-")}}function be(e,n){e&1&&(a(0,"th",25),d(1," Action"),o())}function ye(e,n){if(e&1){let i=b();a(0,"td",26)(1,"button",27),x("click",function(){let r=g(i).$implicit,s=p(2);return h(s.viewDevice(r.id))}),_(2,"mat-icon",28),o(),a(3,"button",29),x("click",function(){let r=g(i).$implicit,s=p(2);return h(s.viewDeviceLogs(r.id))}),_(4,"mat-icon",28),o(),a(5,"button",30),x("click",function(){let r=g(i).$implicit,s=p(2);return h(s.viewAdminLogs(r.id))}),_(6,"mat-icon",28),o(),a(7,"button",31),x("click",function(){let r=g(i).$implicit,s=p(2);return h(s.deleteConfirmation(r))}),_(8,"mat-icon",32),o()()}e&2&&(l(2),m("svgIcon","heroicons_outline:computer-desktop"),l(2),m("svgIcon","mat_outline:screen_search_desktop"),l(2),m("svgIcon","mat_outline:manage_search"),l(2),m("svgIcon","heroicons_outline:trash"))}function Ie(e,n){e&1&&_(0,"tr",33)}function Ue(e,n){e&1&&_(0,"tr",34)}function Ee(e,n){if(e&1){let i=b();u(0),a(1,"table",14),u(2,15),c(3,fe,2,0,"th",16)(4,ge,2,1,"td",17),f(),u(5,18),c(6,he,2,0,"th",16)(7,ve,2,1,"td",17),f(),u(8,19),c(9,xe,2,0,"th",16)(10,Ce,2,1,"td",17),f(),u(11,20),c(12,we,2,0,"th",16)(13,Se,2,1,"td",17),f(),u(14,21),c(15,be,2,0,"th",16)(16,ye,9,4,"td",17),f(),c(17,Ie,1,0,"tr",22)(18,Ue,1,0,"tr",23),o(),a(19,"mat-paginator",24),x("page",function(r){g(i);let s=p();return h(s.handlePageEvent(r))}),o(),f()}if(e&2){let i=p();l(),m("dataSource",i.zitadelUsers),l(16),m("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky",!0),l(),m("matRowDefColumns",i.displayedColumns),l(),m("ngClass",y(10,_e,i.isLoading))("length",i.pagination.length)("pageIndex",i.pagination.page)("pageSize",i.pagination.size)("pageSizeOptions",i.pageSize)("showFirstLastButtons",!0)}}function ze(e,n){e&1&&(a(0,"div",36),d(1," There are no users! "),o())}function Me(e,n){if(e&1&&c(0,ze,2,0,"div",35),e&2){let i=p();m("ngIf",!i.isLoading)}}function Te(e,n){e&1&&(u(0),a(1,"div",37),_(2,"mat-progress-spinner",38),a(3,"h4",39),d(4,"Fetching your zitadel users..."),o()(),f())}var de=(()=>{let n=class n{constructor(t,r,s,S,ce){this._activatedRoute=t,this._fuseConfirmationService=r,this._router=s,this._zitadelUsersService=S,this.router=ce,this._subscription=new U,this.displayedColumns=["name","email","zitadel_user_id","tenant_id","action"],this.pageSize=le,this.pagination={length:0,page:0,size:this.pageSize[0]},this.alert={type:"success",message:""},this.showAlert=!1,this.isLoading=!1}ngOnInit(){this.pagination.page=Number(this._activatedRoute.snapshot.queryParamMap.get("page")??0),this.pagination.size=Number(this._activatedRoute.snapshot.queryParamMap.get("size")??this.pageSize[0]),this.isLoading=!0,this.getZitadelUsers()}viewDevice(t){this.router.navigate([w.DEVICES],{queryParams:{zitadel_user_id:t}}).then()}viewDeviceLogs(t){this.router.navigate([w.DEVICE_LOGS],{queryParams:{zitadel_user_id:t}}).then()}viewAdminLogs(t){this.router.navigate([w.ADMIN_LOGS],{queryParams:{zitadel_user_id:t}}).then()}getZitadelUsers(){this.isLoading=!0,this.queryParamHandler(),this._subscription.add(this._zitadelUsersService.getZitadelUsers(this.pagination).subscribe({next:t=>{this.zitadelUsers=t.items,this.pagination.length=t.total,this.isLoading=!1},error:t=>{t.status!==404&&this.onFailed(t.status===500?"500: Internal Server Error":t.error.detail),this.isLoading=!1}}))}queryParamHandler(){this._router.navigate(["."],{relativeTo:this._activatedRoute,queryParams:{page:this.pagination.page,size:this.pagination.size}}).then()}handlePageEvent(t){this.pagination.length=t.length,this.pagination.size=t.pageSize,this.pagination.page=t.pageIndex,this.getZitadelUsers()}deleteConfirmation(t){this._subscription.add(this._fuseConfirmationService.open({title:"Remove this user",message:"This will remove the user from the shared devices as well as from any device users owned by the user.",icon:{show:!0,name:"heroicons_outline:exclamation-triangle",color:"warn"},actions:{confirm:{show:!0,label:"Remove",color:"warn"},cancel:{show:!0,label:"Cancel"}},dismissible:!0}).afterClosed().subscribe(r=>{r==="confirmed"&&this.deleteZitadelUser(t)}))}deleteZitadelUser(t){this.isLoading=!0,this.showAlert=!1,this._subscription.add(this._zitadelUsersService.deleteZitadelUser(t.id).subscribe({next:()=>this.getZitadelUsers(),error:r=>this.onFailed(r.status===500?"500: Internal Server Error":r.error)}))}onFailed(t){this.alert={type:"error",message:t},this.showAlert=!0,this.isLoading=!1}ngOnDestroy(){this._subscription?.unsubscribe()}};n.\u0275fac=function(r){return new(r||n)(v(R),v(H),v(I),v(me),v(I))},n.\u0275cmp=E({type:n,selectors:[["app-zitadel-users"]],standalone:!0,features:[T],decls:15,vars:7,consts:[["noClients",""],[1,"sm:absolute","sm:inset-0","flex","flex-col","flex-auto","min-w-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"border-b"],[1,"flex","flex-col","w-full","px-6"],[1,"flex","flex-col","sm:flex-row","flex-auto","sm:items-center","min-w-0","my-8"],[1,"flex","flex-auto","items-center","min-w-0"],[1,"flex","flex-col","min-w-0","ml-4"],["id","Clients",1,"text-2xl","md:text-5xl","font-semibold","tracking-tight","leading-7","md:leading-snug","truncate"],["class","mb-6",3,"appearance","showIcon","type",4,"ngIf"],[1,"relative","flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:overflow-y-auto",3,"ngClass"],[4,"ngIf","ngIfElse"],[4,"ngIf"],[1,"mb-6",3,"appearance","showIcon","type"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","email"],["matColumnDef","zitadel_user_id"],["matColumnDef","tenant_id"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"page","ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","matTooltip","view devices",3,"click"],[1,"icon-size-5",3,"svgIcon"],["mat-icon-button","","matTooltip","view device logs",3,"click"],["mat-icon-button","","matTooltip","view admin logs",3,"click"],["mat-icon-button","","matTooltip","delete",3,"click"],[1,"icon-size-5","text-red-500",3,"svgIcon"],["mat-header-row",""],["mat-row",""],["class","p-8 sm:p-16 text-4xl font-semibold tracking-tight text-center",4,"ngIf"],[1,"p-8","sm:p-16","text-4xl","font-semibold","tracking-tight","text-center"],[1,"w-full","h-full","flex","flex-col","justify-center","items-center","bg-default"],["color","primary","diameter","50","strokeWidth","5","mode","indeterminate"],[1,"mt-16"]],template:function(r,s){if(r&1&&(a(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7),d(7," Zitadel Users "),o()()()(),c(8,ue,2,5,"fuse-alert",8),o()(),a(9,"div",9)(10,"div",10),c(11,Ee,20,12,"ng-container",11)(12,Me,1,1,"ng-template",null,0,Z)(14,Te,5,0,"ng-container",12),o()()()),r&2){let S=z(13);l(8),m("ngIf",!s.isLoading&&s.showAlert),l(2),m("ngClass",y(5,pe,(s.zitadelUsers==null?null:s.zitadelUsers.length)>0)),l(),m("ngIf",(s.zitadelUsers==null?null:s.zitadelUsers.length)>0)("ngIfElse",S),l(3),m("ngIf",s.isLoading&&!s.zitadelUsers)}},dependencies:[W,P,A,V,O,K,J,G,B,$,q,k,N,F,L,D,se,Q,Y,ne,ee,X,ae,te,ie,oe,re],data:{animation:j}});let e=n;return e})();var at=[{path:"",component:de}];export{at as default};
